name: run klines_caching_service make tests on Pull Request
on: pull_request

jobs:
  make_tests:
    name: Run make tests
    runs-on: ubuntu-latest
    env:
      ACTIONS_ALLOW_UNSECURE_COMMANDS: true
    steps:
      - name: Check out the repo
        uses: actions/checkout@v2

      - name: install build-essentials
        run: sudo apt-get -y install build-essential

      - name: pyenv install
        uses: "gabrielfalcao/pyenv-action@v5"
        with:
          command: pyenv install

      - name: run klines_caching_service tests
        run: |
          set -e
          cd klines_caching_service
          make tests
